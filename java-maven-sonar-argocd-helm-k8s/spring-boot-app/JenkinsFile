pipeline {
    agent { 
    docker { 
      image 'maven:3.8.6-openjdk-11'
      args '--entrypoint="" -v /etc/resolv.conf:/etc/resolv.conf:ro'
}

    stages {

        stage('Checkout') {
            steps {
                echo "passed"
            }
        }

        stage('Build and Test') {
            steps {
                sh '''
                cd java-maven-sonar-argocd-helm-k8s/spring-boot-app
                mvn -B -DskipTests=false clean package
                '''
            }
        }

        stage('Static Code Analysis') {
            steps {
                echo "Static Code Analysis"
            }
        }

        stage('Build and Push Docker Image') {
            steps {
                echo "Building Docker Image..."
            }
        }

        stage('Update Deployment File') {
            steps {
                echo "Updating deployment file..."
            }
        }
    }

    post {
        always {
            echo "Pipeline finished with status: FAILURE"
        }
    }
}
